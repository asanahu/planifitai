title = "PlanifitAI secret rules"

[[rules]]
id = "jwt-bearer"
description = "JWT token"
regex = '''(?i)\b(eyJ[a-z0-9_\-]+?\.[a-z0-9_\-]+?\.[a-z0-9_\-]+)\b'''
tags = ["jwt","token","auth"]

[[rules]]
id = "db-connection-string"
description = "DB connection string with credentials"
regex = '''(?i)\b(?:postgres(?:ql)?|mysql|mssql|sqlserver|oracle|redshift|snowflake|clickhouse)(?:\+\w+)?://[^/\s:@]+:[^/\s@]+@[^/\s]+/\S+\b'''
tags = ["database","credentials","url"]

[[rules]]
id = "generic-api-key"
description = "Generic API key or token assignment"
regex = '''(?i)\b(api[_-]?key|token|secret|auth[_-]?token)\b\s*[:=]\s*["']?[a-z0-9_\-]{16,}["']?'''
tags = ["apikey","token"]

# Minimiza falsos positivos en tests y fixtures
[allowlist]
description = "Test fixtures, docs and historical dev credentials"
paths = [
  '''tests/test_profile_idor.py$''',
  '''README\.md$'''
]
commits = [
  "d6e4316d30f94ae190279c169bb4eef73a09ee5d",
  "70866c192663111bfaaa3bb942c40e3487b9a7c9",
  "652ef5062c5683cdf041612ab4b44952368cb716",
  "c73cdd864af0a3b84c93167274567fd53ab2b9b2"
]
